{"version":3,"sources":["../src/index.js"],"names":[],"mappings":";;;;;kBAGwB,c;;AAFxB;;;;;;EAEe,SAAS,cAAT,CAAwB,MAAxB,EAAgC,OAAhC,EAAyC;AACpD,QAAI,CAAC,OAAO,QAAZ,EAAsB;AAClB;AACH;;AAED,WAAO,KAAP,GAAe,OAAO,KAAP,IAAgB,EAA/B;;AAEA,UAAM,QAAQ,OAAO,QAAP,CAAgB,KAAhB,IAAyB,OAAO,QAAP,CAAgB,GAAvD;;AAEA,QAAI,EAAE,iBAAiB,KAAnB,CAAJ,EAA+B;AAC3B;AACH;;AAED,WAAO,OAAO,QAAP,CAAgB,KAAvB;AACA,WAAO,OAAO,QAAP,CAAgB,GAAvB;;AAEA,QAAI,MAAM,aAAV,EAAyB;;AAErB,eAAO,QAAP,CAAgB,KAAhB,GAAwB,KAAxB;AACH,KAHD,MAGO;AACH,YAAI;AACA,kBAAM,cAAc,qBAAW,KAAX,CAApB;AACA,mBAAO,QAAP,CAAgB,KAAhB,GAAwB,WAAxB;AACH,SAHD,CAGE,OAAO,GAAP,EAAY;AACV,oBAAQ,GAAR,CAAY,IAAI,KAAJ,IAAa,IAAI,OAAjB,IAA4B,GAAxC;AACA,mBAAO,QAAP,CAAgB,KAAhB,GAAwB,KAAxB;AACH;AACJ;AACJ,C","file":"index.js","sourcesContent":["/* eslint no-console: \"off\" */\nimport { parse as parseError } from 'alouette';\n\nexport default function errorProcessor(record, context) {\n    if (!record.metadata) {\n        return;\n    }\n\n    record.extra = record.extra || {};\n\n    const error = record.metadata.error || record.metadata.err;\n\n    if (!(error instanceof Error)) {\n        return;\n    }\n\n    delete record.metadata.error;\n    delete record.metadata.err;\n\n    if (error.originalError) {\n        // error was already parsed\n        record.metadata.error = error;\n    } else {\n        try {\n            const parsedError = parseError(error);\n            record.metadata.error = parsedError;\n        } catch (err) {\n            console.log(err.stack || err.message || err);\n            record.metadata.error = error;\n        }\n    }\n}\n"]}