{"version":3,"sources":["../src/index.js"],"names":["errorProcessor","record","context","metadata","extra","error","err","Error","originalError","parsedError","console","log","stack","message"],"mappings":";;;;;kBAGwBA,c;;AAFxB;;AAEe,SAASA,cAAT,CAAwBC,MAAxB,EAAgCC,OAAhC,EAAyC;AACtD,MAAI,CAACD,OAAOE,QAAZ,EAAsB;AACpB;AACD;;AAEDF,SAAOG,KAAP,GAAeH,OAAOG,KAAP,IAAgB,EAA/B;;AAEA,QAAMC,QAAQJ,OAAOE,QAAP,CAAgBE,KAAhB,IAAyBJ,OAAOE,QAAP,CAAgBG,GAAvD;;AAEA,MAAI,EAAED,iBAAiBE,KAAnB,CAAJ,EAA+B;AAC7B;AACD;;AAED,SAAON,OAAOE,QAAP,CAAgBE,KAAvB;AACA,SAAOJ,OAAOE,QAAP,CAAgBG,GAAvB;;AAEA,MAAID,MAAMG,aAAV,EAAyB;AACnB;AACJP,WAAOE,QAAP,CAAgBE,KAAhB,GAAwBA,KAAxB;AACD,GAHD,MAGO;AACL,QAAI;AACF,YAAMI,cAAc,qBAAWJ,KAAX,CAApB;AACAJ,aAAOE,QAAP,CAAgBE,KAAhB,GAAwBI,WAAxB;AACD,KAHD,CAGE,OAAOH,GAAP,EAAY;AACZI,cAAQC,GAAR,CAAYL,IAAIM,KAAJ,IAAaN,IAAIO,OAAjB,IAA4BP,GAAxC;AACAL,aAAOE,QAAP,CAAgBE,KAAhB,GAAwBA,KAAxB;AACD;AACF;AACF,C,CA/BD","file":"index.js","sourcesContent":["/* eslint no-console: \"off\" */\nimport { parse as parseError } from 'alouette';\n\nexport default function errorProcessor(record, context) {\n  if (!record.metadata) {\n    return;\n  }\n\n  record.extra = record.extra || {};\n\n  const error = record.metadata.error || record.metadata.err;\n\n  if (!(error instanceof Error)) {\n    return;\n  }\n\n  delete record.metadata.error;\n  delete record.metadata.err;\n\n  if (error.originalError) {\n        // error was already parsed\n    record.metadata.error = error;\n  } else {\n    try {\n      const parsedError = parseError(error);\n      record.metadata.error = parsedError;\n    } catch (err) {\n      console.log(err.stack || err.message || err);\n      record.metadata.error = error;\n    }\n  }\n}\n"]}