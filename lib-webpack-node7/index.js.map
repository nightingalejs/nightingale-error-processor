{"version":3,"sources":["../src/index.js"],"names":["parse","parseError","errorProcessor","record","metadata","extra","error","err","Error","originalError","parsedError","console","log","stack","message"],"mappings":"AAAA;AACA,SAASA,SAASC,UAAlB,QAAoC,UAApC;;AAEA,eAAe,SAASC,cAAT,CAAwBC,MAAxB,EAAyC;AACtD,MAAI,CAACA,OAAOC,QAAZ,EAAsB;AACpB;AACD;;AAEDD,SAAOE,KAAP,GAAeF,OAAOE,KAAP,MAAf;;AAEA,QAAMC,QAAQH,OAAOC,QAAP,CAAgBE,KAAhB,IAAyBH,OAAOC,QAAP,CAAgBG,GAAvD;;AAEA,MAAI,EAAED,iBAAiBE,KAAnB,CAAJ,EAA+B;AAC7B;AACD;;AAED,SAAOL,OAAOC,QAAP,CAAgBE,KAAvB;AACA,SAAOH,OAAOC,QAAP,CAAgBG,GAAvB;;AAEA,MAAID,MAAMG,aAAV,EAAyB;AACvB;AACAN,WAAOC,QAAP,CAAgBE,KAAhB,GAAwBA,KAAxB;AACD,GAHD,MAGO;AACL,QAAI;AACF,YAAMI,cAAcT,WAAWK,KAAX,CAApB;AACAH,aAAOC,QAAP,CAAgBE,KAAhB,GAAwBI,WAAxB;AACD,KAHD,CAGE,OAAOH,GAAP,EAAY;AACZI,cAAQC,GAAR,CAAYL,IAAIM,KAAJ,IAAaN,IAAIO,OAAjB,IAA4BP,GAAxC;AACAJ,aAAOC,QAAP,CAAgBE,KAAhB,GAAwBA,KAAxB;AACD;AACF;AACF","file":"index.js","sourcesContent":["/* eslint no-console: \"off\" */\nimport { parse as parseError } from 'alouette';\n\nexport default function errorProcessor(record, context) {\n  if (!record.metadata) {\n    return;\n  }\n\n  record.extra = record.extra || {};\n\n  const error = record.metadata.error || record.metadata.err;\n\n  if (!(error instanceof Error)) {\n    return;\n  }\n\n  delete record.metadata.error;\n  delete record.metadata.err;\n\n  if (error.originalError) {\n    // error was already parsed\n    record.metadata.error = error;\n  } else {\n    try {\n      const parsedError = parseError(error);\n      record.metadata.error = parsedError;\n    } catch (err) {\n      console.log(err.stack || err.message || err);\n      record.metadata.error = error;\n    }\n  }\n}\n"]}